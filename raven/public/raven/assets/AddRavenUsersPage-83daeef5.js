import{j as e,q as Y,ev as I,ew as M,r as u,aw as O,ax as W,az as U,aA as j,aW as _,ay as F,ex as G,aB as f,a as n,a0 as K,ey as q,p as m,a3 as J,aC as X,aV as H,av as Q,ez as Z,K as v,af as k,eA as ee,x as P,i as g,cK as R,o as y,f as S,bs as se,U as ae,c as ne,b as re,m as te,a_ as ce,E as le,eB as ie,e as oe,$ as de}from"./index-81db420b.js";import{u as he}from"./useDebounce-02f398f3.js";import{u as xe,P as je,a as ue}from"./PageSelector-75a82642.js";import{T as ge}from"./TableLoader-47d8c4ae.js";import"./Skeleton-9de30e70.js";const me=({sortOrder:a,onSortOrderChange:c})=>{const t=()=>{c(a==="asc"?"desc":"asc")};return e.jsx(Y,{size:"1",color:"gray",variant:"soft",title:a==="asc"?"newest first":"oldest first",onClick:t,"aria-label":a==="asc"?"click to sort by newest first":"click to sort by oldest first",children:a==="asc"?e.jsx(I,{}):e.jsx(M,{})})},pe=({data:a,selected:c,setSelected:t,defaultSelected:o})=>{const p=s=>{t(s?r=>{const l=[];return a.forEach(i=>{!c.includes(i.name)&&!o.includes(i.name)&&l.push(i.name)}),[...r,...l]}:[])},h=u.useMemo(()=>{if(a&&a.length){let s=!0;return a==null||a.forEach(r=>{!c.includes(r.name)&&!o.includes(r.name)&&(s=!1)}),s}else return!1},[c,a]),w=s=>{t(r=>r.includes(s)?r.filter(l=>l!==s):[...r,s])};return e.jsxs(O,{variant:"surface",className:"rounded-sm",children:[e.jsx(W,{children:e.jsxs(U,{children:[e.jsx(j,{children:e.jsx(_,{checked:h,onCheckedChange:s=>p(!!s.valueOf())})}),e.jsx(j,{children:"Name"}),e.jsx(j,{children:"User ID"}),e.jsx(j,{children:"Created on"}),e.jsx(j,{})]})}),e.jsx(F,{children:a==null?void 0:a.map((s,r)=>{var i;const l=c.includes(s.name)||o.includes(s.name);return e.jsxs(U,{children:[e.jsx(G,{children:e.jsx(_,{checked:l,disabled:o.includes(s.name),onCheckedChange:()=>w(s.name)})}),e.jsx(f,{children:e.jsxs(n,{gap:"2",align:"center",children:[e.jsx(K,{src:s.user_image,alt:s.full_name}),(i=s.full_name)!=null?i:"-"]})}),e.jsx(f,{children:s.name}),e.jsx(f,{children:e.jsx(q,{date:s.creation})}),e.jsx(f,{children:s.role_profile_name?e.jsx(m,{children:e.jsx(J,{content:e.jsxs("span",{children:["A role profile has been assigned to this user.",e.jsx("br",{}),"If you want to add the user to Raven, please change their role profile."]}),children:e.jsxs(X,{color:"red",variant:"solid",children:[e.jsx(H,{size:"12"}),"Role Profile Added"]})})}):null})]},r)})})]})},Ne=()=>{const a=Q();return e.jsx(Z,{children:e.jsx(n,{align:"center",justify:"center",className:"h-screen",children:a?e.jsx(ve,{}):e.jsx(fe,{})})})},$="rounded-radius4",z="p-4 shadow-accent-a2 shadow-lg dark:shadow-accent-a2 dark:shadow-md",fe=()=>e.jsx(m,{className:v($,"bg-accent-a4"),children:e.jsx(k,{className:v(z,"max-w-md"),children:e.jsxs(n,{direction:"column",align:"center",gap:"4",children:[e.jsx(m,{py:"1",children:e.jsx(n,{align:"center",justify:"center",className:"text-accent-11 bg-accent-a4 rounded-full p-4",children:e.jsx(ee,{size:24})})}),e.jsxs(n,{direction:"column",align:"center",gap:"2",children:[e.jsxs(P,{as:"h2",className:"not-cal",size:"4",children:["You do not have access to ",e.jsx(g,{className:"cal-sans",children:"Raven"}),"."]}),e.jsxs(g,{as:"p",size:"2",align:"center",className:"leading-6",children:["Please contact your Administrator or System Manager to give you the ",e.jsx(R,{children:'"Raven User"'})," role."]}),e.jsxs(n,{gap:"3",direction:"column",py:"1",pt:"3",children:[e.jsx(y,{asChild:!0,children:e.jsx(S,{className:"text-white",href:"/app/raven-user",children:"View Raven Users"})}),e.jsx(y,{variant:"outline",onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})]})})}),ve=()=>{const[a,c]=u.useState(""),t=he(a),o=x=>{c(x.target.value)},p=[["enabled","=",1],["name","not in",["Guest","Administrator"]],["user_type","!=","Website User"],["full_name","like",`%${t}%`]],{start:h,count:w,selectedPageLength:s,setPageLength:r,nextPage:l,previousPage:i}=xe("User",10,p),[C,T]=u.useState("desc"),{data:d,error:B}=se("User",{fields:["name","full_name","user_image","creation","enabled","user_type"],filters:p,orderBy:{field:"creation",order:C},limit_start:h>0?h-1:0,limit:s}),{currentUser:N}=u.useContext(ae),[b,E]=u.useState([]),{loading:A,call:L,error:D}=ne("raven.api.raven_users.add_users_to_raven"),V=()=>{L({users:JSON.stringify([...b,N])}).then(()=>{de.success(`You have added ${b.length} users to Raven`),window.location.reload()})};return e.jsx(m,{className:v($,"bg-accent-a2"),children:e.jsxs(k,{className:v(z,"max-w-xl min-w-[720px]"),children:[e.jsxs(n,{gap:"2",direction:"column",children:[e.jsx(P,{as:"h1",children:"Add users to Raven"}),e.jsxs(g,{as:"p",size:"2",className:"leading-6",children:["Users you add will be given the ",e.jsx(R,{children:'"Raven User"'})," role."]})]}),e.jsxs(n,{direction:"column",gap:"4",pt:"4",className:"max-h-[80vh]",children:[e.jsxs(n,{justify:"between",gap:"2",children:[e.jsxs(n,{gap:"2",align:"center",children:[e.jsx(re,{style:{width:"320px"},onChange:o,value:a,type:"text",placeholder:"Search for user",children:e.jsx(te,{side:"left",children:e.jsx(ce,{})})}),t.length>0&&t.length<2&&e.jsx(g,{size:"1",color:"gray",children:"Continue typing..."})]}),e.jsxs(n,{justify:"end",gap:"2",align:"center",children:[e.jsx(me,{sortOrder:C,onSortOrderChange:x=>T(x)}),e.jsx(je,{options:[10,20,50,100],selectedValue:s,updateValue:x=>r(x)}),e.jsx(ue,{rowsPerPage:s,start:h,totalRows:w,gotoNextPage:()=>l(),gotoPreviousPage:()=>i()})]})]}),!d&&!B&&e.jsx(ge,{columns:3}),d&&d.length===0&&t.length>=2&&e.jsx(n,{align:"center",justify:"center",className:"min-h-[32rem]",children:e.jsx(g,{size:"2",align:"center",children:"No results found"})}),d&&d.length!==0&&e.jsx(pe,{data:d,defaultSelected:[N],selected:b,setSelected:E})]}),e.jsxs(m,{pt:"3",children:[e.jsx(le,{error:D}),e.jsxs(n,{align:"center",gap:"2",justify:"between",pt:"3",children:[e.jsx(n,{align:"center",gap:"2",children:e.jsx(y,{color:"gray",variant:"soft",asChild:!0,children:e.jsxs(S,{href:"/app",className:"flex items-center",children:[e.jsx(ie,{size:"20"}),"Go back to Desk"]})})}),e.jsxs(y,{type:"button",disabled:A,onClick:V,children:[A&&e.jsx(oe,{}),A?"Adding":"Add to Raven"]})]})]})]})})};export{Ne as default};
