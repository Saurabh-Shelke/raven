var W=Object.defineProperty,G=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var F=(n,i,s)=>i in n?W(n,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[i]=s,h=(n,i)=>{for(var s in i||(i={}))$.call(i,s)&&F(n,s,i[s]);if(y)for(var s of y(i))A.call(i,s)&&F(n,s,i[s]);return n},m=(n,i)=>G(n,H(i));var q=(n,i)=>{var s={};for(var o in n)$.call(n,o)&&i.indexOf(o)<0&&(s[o]=n[o]);if(n!=null&&y)for(var o of y(n))i.indexOf(o)<0&&A.call(n,o)&&(s[o]=n[o]);return s};var E=(n,i,s)=>new Promise((o,f)=>{var a=t=>{try{x(s.next(t))}catch(g){f(g)}},j=t=>{try{x(s.throw(t))}catch(g){f(g)}},x=t=>t.done?o(t.value):Promise.resolve(t.value).then(a,j);x((s=s.apply(n,i)).next())});import{u as I,aO as J,c as K,j as e,ae as U,a as d,E as X,p as C,L as v,bd as Y,d as P,b as Z,q as ee,br as se,o as w,cr as ne,i as O,aT as R,aW as S,au as ie,$ as T,ac as oe}from"./index-81db420b.js";const ae=({channelID:n,setIsOpen:i})=>{var k;const s=I({defaultValues:{options:[{name:"",creation:"",modified:"",owner:"",modified_by:"",docstatus:0,option:""},{name:"",creation:"",modified:"",owner:"",modified_by:"",docstatus:0,option:""}]}}),{register:o,handleSubmit:f,formState:{errors:a},control:j,reset:x}=s,{fields:t,remove:g,append:B}=J({control:j,name:"options"}),L=()=>{t.length>=10||B({name:"",creation:"",modified:"",owner:"",modified_by:"",docstatus:0,option:""})},M=l=>{t.length!==2&&g(l)},N=()=>{x()},_=()=>{i(!1),N()},{call:Q,error:D}=K("raven.api.raven_poll.create_poll"),V=l=>E(void 0,null,function*(){return Q(m(h({},l),{channel_id:n})).then(()=>{T.success("Poll created"),_()}).catch(r=>{T.error("There was an error.",{description:oe(r)})})});return e.jsx(U,m(h({},s),{children:e.jsx("form",{onSubmit:f(V),children:e.jsxs(d,{direction:"column",gap:"4",py:"2",children:[e.jsx(X,{error:D}),e.jsxs(C,{children:[e.jsx(v,{htmlFor:"question",isRequired:!0,children:"Question"}),e.jsx(Y,m(h({},o("question",{required:"Question is required"})),{placeholder:"Ask a question to gather responses",required:!0})),(a==null?void 0:a.question)&&e.jsx(P,{children:(k=a.question)==null?void 0:k.message})]}),e.jsxs(C,{children:[e.jsx(v,{htmlFor:"options",isRequired:!0,children:"Options"}),e.jsxs(d,{direction:"column",gap:"2",children:[t&&t.map((l,r)=>{var b,u,c,p,z;return e.jsxs(d,{gap:"2",align:"start",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(Z,h({placeholder:`Option ${r+1}`},o(`options.${r}.option`,{required:"Option is required",minLength:{value:1,message:"Option cannot be empty"}}))),((u=(b=a==null?void 0:a.options)==null?void 0:b[r])==null?void 0:u.option)&&e.jsx(P,{children:(z=(p=(c=a.options)==null?void 0:c[r])==null?void 0:p.option)==null?void 0:z.message})]}),e.jsx(ee,{mt:"2",disabled:t.length===2,color:"red","aria-label":"delete",variant:"ghost",size:"1",title:"Remove Option",onClick:()=>M(r),children:e.jsx(se,{size:"12"})})]},l.id)}),e.jsxs(d,{justify:"between",align:"center",children:[e.jsxs(w,{disabled:t.length>=10,type:"button",size:"1",variant:"ghost",style:{width:"fit-content"},onClick:L,children:[e.jsx(ne,{size:"14"}),"Add Option"]}),e.jsx(O,{size:"1",className:"text-gray-500",children:"Maximum of 10 options allowed"})]})]})]}),e.jsxs(C,{children:[e.jsx(v,{children:"Settings"}),e.jsxs(d,{direction:"column",gap:"2",children:[e.jsx(O,{as:"label",size:"2",children:e.jsxs(d,{gap:"2",align:"center",children:[e.jsx(R,{name:"is_multi_choice",control:j,render:b=>{var{field:u}=b,c=u,{onChange:l}=c,r=q(c,["onChange"]);return e.jsx(S,m(h({},r),{onCheckedChange:p=>l(p?1:0)}))}}),"Allow users to select multiple options"]})}),e.jsx(O,{as:"label",size:"2",children:e.jsxs(d,{gap:"2",align:"center",children:[e.jsx(R,{name:"is_anonymous",control:j,render:b=>{var{field:u}=b,c=u,{onChange:l}=c,r=q(c,["onChange"]);return e.jsx(S,m(h({},r),{onCheckedChange:p=>l(p?1:0)}))}}),"Make this poll anonymous"]})})]})]}),e.jsxs(d,{gap:"3",mt:"4",justify:"end",children:[e.jsx(ie,{children:e.jsx(w,{variant:"soft",color:"gray",onClick:_,children:"Cancel"})}),e.jsx(w,{type:"submit",children:"Create"})]})]})})}))};export{ae as default};
