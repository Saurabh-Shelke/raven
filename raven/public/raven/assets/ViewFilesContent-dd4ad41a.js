import{G as J,$ as K,M as b,j as e,aw as Y,ax as H,az as T,aA as t,ay as Q,aB as c,du as o,p as v,ag as k,ah as F,i as p,eF as X,a as n,a0 as Z,ey as ee,b$ as se,bv as ae,bw as ne,by as re,eb as ie,a3 as f,o as w,dd as E,de as W,ca as A,aj as le,ak as _,r as C,bg as te,W as D,aq as ce,au as oe,q as xe,b as de,m as L,a_ as he,e as je,aI as pe,aJ as ge,aK as me,bO as ue,bP as ye,aL as h,E as S,x as fe}from"./index-81db420b.js";import{u as we}from"./useDebounce-02f398f3.js";import{b as _e,P as ve,a as be}from"./PageSelector-75a82642.js";import{T as ze}from"./TableLoader-47d8c4ae.js";import"./Skeleton-9de30e70.js";function Ne(a){return J({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"},child:[]}]})(a)}const M=a=>()=>{a.startsWith("http")||a.startsWith("https")?navigator.clipboard.writeText(a):navigator.clipboard.writeText(window.location.origin+a),K.success("Link copied")},Pe=({data:a})=>b()?e.jsxs(Y,{variant:"surface",className:"overflow-scroll",children:[e.jsx(H,{children:e.jsxs(T,{children:[e.jsx(t,{children:"Preview"}),e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Size"}),e.jsx(t,{children:"Sent by"}),e.jsx(t,{children:"Shared on"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(Q,{children:a==null?void 0:a.map((s,j)=>{var i,r,g;return e.jsxs(T,{children:[e.jsx(c,{children:s.message_type==="File"?e.jsx(o,{ext:(r=(i=s.file_type)==null?void 0:i.toLowerCase())!=null?r:"file",style:{paddingLeft:"4"}}):e.jsx($,{file:s})}),e.jsx(c,{children:e.jsx(v,{className:"relative",style:{cursor:"pointer",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.jsxs(k,{children:[e.jsx(F,{children:e.jsx(p,{children:s.file_name})}),e.jsx(I,{file:s.file_url})]})})}),e.jsx(c,{children:s.file_type?s.file_type:"File"}),e.jsx(c,{children:X(s.file_size)}),e.jsx(c,{children:e.jsxs(n,{gap:"2",align:"center",children:[e.jsx(Z,{src:s.user_image,alt:s.full_name}),(g=s.full_name)!=null?g:"-"]})}),e.jsx(c,{children:e.jsx(ee,{date:s.creation})}),e.jsx(c,{children:e.jsx(B,{file:s.file_url})})]},s.name)})})]}):e.jsx(n,{direction:"column",gap:"3",className:"overflow-scroll pb-4",children:a==null?void 0:a.map(s=>{var j,i,r;return e.jsxs(n,{align:"center",justify:"between",className:"border-b border-gray-4 dark:border-gray-6`} pb-3",children:[e.jsx(n,{direction:"column",children:e.jsxs(n,{gap:"2",align:"center",children:[e.jsx(n,{className:"w-8 items-center justify-center",children:s.message_type==="File"?e.jsx(o,{ext:(i=(j=s.file_type)==null?void 0:j.toLowerCase())!=null?i:"file",className:"px-2"}):e.jsx($,{file:s})}),e.jsxs(v,{className:"relative",style:{cursor:"pointer",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsxs(k,{children:[e.jsx(F,{children:e.jsx(p,{size:"2",as:"span",className:"text-ellipsis",children:s.file_name})}),e.jsx(I,{file:s.file_url})]}),e.jsx(n,{gap:"2",align:"center",children:e.jsxs(p,{size:"1",color:"gray",children:["by ",(r=s.full_name)!=null?r:s.owner," on ",e.jsx(se,{date:s.creation})]})})]})]})}),e.jsx(B,{file:s.file_url})]},s.name)})}),$=({file:a})=>e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsx("img",{style:{borderRadius:"4px"},src:a.file_url,alt:a.file_name,className:"object-cover w-8 h-8 sm:w-[25px] sm:h-[25px]"})}),e.jsx(re,{children:e.jsx(ie,{side:"all",mb:"0",className:"-mb-6",children:e.jsx("img",{src:a.file_thumbnail||a.file_url,alt:a.file_name,height:a.thumbnail_height||"200px",width:a.thumbnail_width||"200px",className:"object-cover"})})})]}),B=({file:a})=>{const l=M(a),s=b();return e.jsxs(n,{gap:"2",children:[e.jsx(f,{content:"Copy link",children:e.jsx(w,{variant:"soft",color:"gray",size:"1",onClick:l,children:e.jsx(E,{size:"16"})})}),e.jsx(f,{content:"Download",children:e.jsx("a",{download:!0,href:a,children:e.jsx(w,{variant:"soft",color:"gray",size:"1",children:e.jsx(W,{size:"16"})})})}),s&&e.jsx(f,{content:"Open in new tab",children:e.jsx("a",{href:a,target:"_blank",rel:"noreferrer",children:e.jsx(w,{variant:"soft",color:"gray",size:"1",children:e.jsx(A,{size:"14"})})})})]})},I=({file:a})=>{const l=M(a);return e.jsxs(le,{children:[e.jsx(_,{onClick:l,children:e.jsxs(n,{gap:"2",children:[e.jsx(E,{size:"18"}),"Copy link"]})}),e.jsx(_,{children:e.jsx("a",{download:!0,href:a,children:e.jsxs(n,{gap:"2",children:[e.jsx(W,{size:"18"}),"Download"]})})}),e.jsx(_,{children:e.jsx("a",{href:a,target:"_blank",rel:"noreferrer",children:e.jsxs(n,{gap:"2",children:[e.jsx(A,{size:"16"}),"Open in new tab"]})})})]})},Le=()=>{var N,P;const[a,l]=C.useState(""),s=we(a,200),j=y=>{l(y.target.value)},{channelID:i}=te(),[r,g]=C.useState(),{data:x,error:O}=D("raven.api.raven_message.get_count_for_pagination_of_files",{channel_id:i,file_name:s,file_type:r==="any"?void 0:r}),{start:m,selectedPageLength:u,setPageLength:R,nextPage:V,previousPage:q}=_e(10,(N=x==null?void 0:x.message)!=null?N:0),{data:d,error:z,isLoading:G}=D("raven.api.raven_message.get_all_files_shared_in_channel",{channel_id:i,file_name:s,file_type:r==="any"?void 0:r,start_after:m>0?m-1:0,page_length:u}),U=b();return e.jsxs("div",{children:[e.jsxs(n,{justify:"between",gap:"2",children:[e.jsx(ce,{children:"Files shared in this channel"}),U&&e.jsx(oe,{children:e.jsx(xe,{size:"1",color:"gray",variant:"soft","aria-label":"close dialog",children:e.jsx(Ne,{})})})]}),e.jsxs(n,{direction:"column",gap:"4",className:"pt-0 sm:pt-4 h-[80vh] sm:max-h-[75vh] sm:min-h-[75vh]",children:[e.jsxs(n,{justify:"between",gap:"2",className:"flex-col sm:flex-row",children:[e.jsxs(n,{gap:"2",className:"flex-col sm:flex-row sm:items-center",children:[e.jsxs(de,{className:"w-full sm:w-[400px]",onChange:j,type:"text",placeholder:"Search for file",autoFocus:!0,children:[e.jsx(L,{side:"left",children:e.jsx(he,{})}),e.jsx(L,{side:"right",children:G&&e.jsx(je,{})})]}),e.jsxs(pe,{value:r,onValueChange:g,children:[e.jsx(ge,{placeholder:"File Type",className:"w-full sm:w-[200px]"}),e.jsx(me,{className:"z-50",children:e.jsxs(ue,{children:[e.jsx(ye,{children:"File Type"}),e.jsx(h,{value:"any",children:e.jsxs(n,{align:"center",gap:"1",children:[e.jsx(v,{width:"16px",children:"🤷🏻‍♀️"}),"Any"]})}),e.jsx(h,{value:"pdf",children:e.jsxs(n,{gap:"2",children:[e.jsx(o,{ext:"pdf",size:"14",style:{paddingTop:2}}),"PDF"]})}),e.jsx(h,{value:"doc",children:e.jsxs(n,{gap:"2",children:[e.jsx(o,{ext:"doc",size:"14",style:{paddingTop:2}}),"Documents (.doc)"]})}),e.jsx(h,{value:"ppt",children:e.jsxs(n,{gap:"2",children:[e.jsx(o,{ext:"ppt",size:"14",style:{paddingTop:2}}),"Presentations (.ppt)"]})}),e.jsx(h,{value:"xls",children:e.jsxs(n,{gap:"2",children:[e.jsx(o,{ext:"xls",size:"14",style:{paddingTop:2}}),"Spreadsheets (.xls)"]})}),e.jsx(h,{value:"image",children:e.jsxs(n,{gap:"2",children:[e.jsx(o,{ext:"jpg",size:"14",style:{paddingTop:2}}),"Images"]})})]})})]}),s.length>0&&s.length<2&&e.jsx(p,{size:"1",color:"gray",children:"Continue typing..."})]}),e.jsxs(n,{justify:"end",gap:"2",align:"center",children:[e.jsx(ve,{options:[10,20,50,100],selectedValue:u,updateValue:y=>R(y)}),e.jsx(be,{rowsPerPage:u,start:m,totalRows:(P=x==null?void 0:x.message)!=null?P:0,gotoNextPage:()=>V(),gotoPreviousPage:()=>q()})]})]}),e.jsx(S,{error:z}),e.jsx(S,{error:O}),!d&&!z&&e.jsx(ze,{columns:3}),d&&d.message.length===0&&(s.length>=2||s.length==0)&&e.jsxs(n,{align:"center",justify:"center",direction:"column",gap:"2",className:"min-h-[32rem]",children:[e.jsx(fe,{size:"3",children:"Nothing to see here"}),e.jsx(p,{size:"2",align:"center",children:"No files found in this channel"})]}),d&&d.message.length!==0&&e.jsx(Pe,{data:d.message})]})]})};export{Le as default};
