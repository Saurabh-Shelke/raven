var E=Object.defineProperty,L=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var v=(i,a,s)=>a in i?E(i,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[a]=s,r=(i,a)=>{for(var s in a||(a={}))q.call(a,s)&&v(i,s,a[s]);if(b)for(var s of b(a))F.call(a,s)&&v(i,s,a[s]);return i},l=(i,a)=>L(i,R(a));import{aU as K,av as z,u as N,r as A,ad as T,W as $,j as e,ae as V,o as W,e as H,a as S,i as w,aT as M,aW as U,J,p as m,L as h,b as _,d as g,aM as B,$ as G}from"./index-81db420b.js";import{P as Q,S as X,a as Y}from"./SettingsContentContainer-c8f50a15.js";import{u as Z}from"./useRavenSettings-a6b6461e.js";const ee=()=>{var f,y,I;const i=K()||z(),{ravenSettings:a,mutate:s}=Z(),c=N({disabled:!i}),{handleSubmit:k,control:C,watch:O,reset:P,register:p,formState:{errors:n}}=c;A.useEffect(()=>{a&&P(a)},[a]);const{updateDoc:D,loading:u}=T(),j=t=>{G.promise(D("Raven Settings",null,r(r({},a!=null?a:{}),t)).then(o=>{s(o,{revalidate:!1})}),{loading:"Updating...",success:()=>"Settings updated",error:"There was an error."})};A.useEffect(()=>{const t=o=>{o.key==="s"&&(o.metaKey||o.ctrlKey)&&(o.preventDefault(),c.handleSubmit(j)())};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[]);const d=O("enable_ai_integration"),{data:x}=$("raven.api.ai_features.get_open_ai_version");return e.jsx(Q,{children:e.jsx(V,l(r({},c),{children:e.jsx("form",{onSubmit:k(j),children:e.jsxs(X,{children:[e.jsx(Y,{title:"OpenAI Settings",description:"Set your OpenAI API Key to use AI features in Raven.",actions:e.jsxs(W,{type:"submit",disabled:u||!i,children:[u&&e.jsx(H,{className:"text-white"}),u?"Saving":"Save"]})}),e.jsx(S,{direction:"column",gap:"2",children:e.jsx(w,{as:"label",size:"2",children:e.jsxs(S,{gap:"2",children:[e.jsx(M,{control:C,defaultValue:a==null?void 0:a.enable_ai_integration,name:"enable_ai_integration",render:({field:t})=>e.jsx(U,{checked:!!t.value,name:t.name,disabled:t.disabled,onCheckedChange:o=>t.onChange(o?1:0)})}),"Enable AI Integration"]})})}),e.jsx(J,{size:"4"}),d?e.jsxs(m,{children:[e.jsx(h,{htmlFor:"openai_organisation_id",isRequired:!0,children:"OpenAI Organization ID"}),e.jsx(_,l(r({autoFocus:!0,maxLength:140,className:"w-48 sm:w-96",id:"openai_organisation_id",autoComplete:"off",required:!0,placeholder:"org-************************"},p("openai_organisation_id",{required:d?"Please add your OpenAI Organization ID":!1,maxLength:{value:140,message:"ID cannot be more than 140 characters."}})),{"aria-invalid":n.openai_organisation_id?"true":"false"})),(n==null?void 0:n.openai_organisation_id)&&e.jsx(g,{children:(f=n.openai_organisation_id)==null?void 0:f.message})]}):null,d?e.jsxs(m,{children:[e.jsx(h,{htmlFor:"openai_api_key",isRequired:!0,children:"OpenAI API Key"}),e.jsx(_,l(r({className:"w-48 sm:w-96",id:"openai_api_key",required:!0,type:"password",autoComplete:"off",placeholder:"••••••••••••••••••••••••••••••••"},p("openai_api_key",{required:d?"Please add your OpenAI API Key":!1})),{"aria-invalid":n.openai_api_key?"true":"false"})),(n==null?void 0:n.openai_api_key)&&e.jsx(g,{children:(y=n.openai_api_key)==null?void 0:y.message})]}):null,d?e.jsxs(m,{children:[e.jsx(h,{htmlFor:"openai_project_id",children:"OpenAI Project ID"}),e.jsx(_,l(r({maxLength:140,className:"w-48 sm:w-96",id:"openai_project_id",autoComplete:"off",placeholder:"proj_************************"},p("openai_project_id",{maxLength:{value:140,message:"ID cannot be more than 140 characters."}})),{"aria-invalid":n.openai_project_id?"true":"false"})),(n==null?void 0:n.openai_project_id)&&e.jsx(g,{children:(I=n.openai_project_id)==null?void 0:I.message}),e.jsx(B,{children:"If not set, the integration will use the default project."})]}):null,x&&e.jsxs(w,{color:"gray",size:"2",children:["OpenAI Python SDK Version: ",x.message]})]})})}))})},te=ee;export{te as Component};
