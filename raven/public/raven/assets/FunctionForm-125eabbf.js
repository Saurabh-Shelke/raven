var ye=Object.defineProperty,fe=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var ie=(t,r,o)=>r in t?ye(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,_=(t,r)=>{for(var o in r||(r={}))ve.call(r,o)&&ie(t,o,r[o]);if(re)for(var o of re(r))_e.call(r,o)&&ie(t,o,r[o]);return t},N=(t,r)=>fe(t,be(r));import{r as f,j as e,S as m,at as g,p as C,L as O,aI as Q,aJ as X,aK as Z,aL as S,i as b,aW as te,b as le,aM as F,bd as B,au as Ce,o as E,aN as w,bL as De,aT as P,aC as A,q as J,bM as de,aR as ue,J as ee,a2 as U,a4 as se,a6 as G,a7 as he,aq as V,ar as Y,aQ as ne,$ as we,aO as Ne,af as Se,K as Fe,a3 as qe,bi as Oe,bj as Te,bk as ae,bJ as ke,bN as Ae,bn as oe,aX as Ee,bO as H,bP as K,d as R,aP as ze}from"./index-81db420b.js";import{b as T}from"./validations-18aa1769.js";import{A as Me}from"./AINotEnabledCallout-6cdcef2f.js";import{u as pe}from"./useDoctypeMeta-749cfb81.js";import{D as me}from"./DoctypeVariableDialogForm-2f0c0daa.js";const $=[{value:"Get Document",description:"Fetch any document from the system.",requires_write_permissions:!1,type:"Standard"},{value:"Get Multiple Documents",description:"Fetch multiple document from the system",requires_write_permissions:!1,type:"Bulk Operations"},{value:"Get List",description:"Fetch a list of documents from the system (using filters).",requires_write_permissions:!1,type:"Standard"},{value:"Create Document",description:"Create any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Create Multiple Documents",description:"Create multiple documents in the system in one go.",requires_write_permissions:!0,type:"Bulk Operations"},{value:"Update Document",description:"Update any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Update Multiple Documents",description:"Update multiple documents in the system in one go.",requires_write_permissions:!0,type:"Bulk Operations"},{value:"Delete Document",description:"Delete any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Delete Multiple Documents",description:"Delete multiple documents in the system in one go.",requires_write_permissions:!0,type:"Bulk Operations"},{value:"Custom Function",description:"Custom function to be used in the system.",type:"Other"},{value:"Attach File to Document",description:"Attach a file to any document.",requires_write_permissions:!0,type:"Other"}],xe=({defaultValues:t,onAdd:r,allowNameChange:o,name:a,defaultRequired:i})=>{var M,x,q;const[c,u]=f.useState((t==null?void 0:t.type)||"string"),[h,l]=f.useState(a!=null?a:""),[n,d]=f.useState((M=t==null?void 0:t.description)!=null?M:""),[s,p]=f.useState(i!=null?i:!1),[j,D]=f.useState((t==null?void 0:t.type)==="string"||(t==null?void 0:t.type)==="number"?(x=t==null?void 0:t.enum)!=null?x:[]:[]),[v,k]=f.useState((t==null?void 0:t.type)==="array"?(q=t==null?void 0:t.items)!=null?q:[]:void 0),z=!h||!c||!n,L=()=>{r(h,{type:c,description:n,enum:j.length>0?j:void 0,items:c==="array"?v:void 0},s)};return e.jsxs(m,{gap:"4",pt:"2",children:[e.jsxs(m,{gap:"4",className:"max-h-[75vh] overflow-y-auto",children:[e.jsxs(g,{children:[e.jsxs(m,{width:"50%",gap:"4",children:[e.jsxs(C,{children:[e.jsx(O,{isRequired:!0,children:"Type"}),e.jsxs(Q,{required:!0,value:c,onValueChange:y=>u(y),children:[e.jsx(X,{placeholder:"Select a variable type",className:"w-full"}),e.jsxs(Z,{children:[e.jsx(S,{value:"string",children:"String"}),e.jsx(S,{value:"array",children:"Array"}),e.jsx(S,{value:"number",children:"Number"}),e.jsx(S,{value:"boolean",children:"Boolean"}),e.jsx(S,{value:"object",children:"Object"})]})]})]}),e.jsx(C,{children:e.jsx(b,{as:"label",size:"2",children:e.jsxs(g,{children:[e.jsx(te,{checked:s,onCheckedChange:y=>p(!!y)}),"Required"]})})})]}),e.jsxs(m,{width:"50%",children:[e.jsxs(C,{children:[e.jsx(O,{isRequired:!0,children:"Name"}),e.jsx(le,{name:"name",value:h,required:!0,readOnly:!o,onChange:y=>{var I;return l((I=y.target.value)==null?void 0:I.replace(/\s/g,"_"))}})]}),e.jsx(F,{children:"Variable name must be unique, and cannot have spaces."})]})]}),c==="array"&&e.jsxs(C,{width:"50%",children:[e.jsx(O,{isRequired:!0,children:"Type of items in the array"}),e.jsxs(Q,{value:v==null?void 0:v.type,onValueChange:y=>k(I=>N(_({},I),{type:y})),children:[e.jsx(X,{placeholder:"Select a variable type",className:"w-full"}),e.jsxs(Z,{children:[e.jsx(S,{value:"string",children:"String"}),e.jsx(S,{value:"number",children:"Number"})]})]})]}),e.jsxs(C,{children:[e.jsx(O,{htmlFor:"description",isRequired:!0,children:"Description"}),e.jsx(B,{name:"description",required:!0,value:n,onChange:y=>d(y.target.value),placeholder:"Enter a description for this variable"})]}),(c==="string"||c==="number")&&e.jsx(m,{children:e.jsxs(m,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"enumValues",children:"Options"}),e.jsx(B,{rows:7,resize:"vertical",name:"enumValues",value:j.join(`
`),onChange:y=>D(y.target.value.split(`
`))})]}),e.jsx(F,{children:"Add a new option on a new line. If you want this variable to have a default value, just add one option."})]})})]}),e.jsxs(g,{justify:"end",children:[e.jsx(Ce,{children:e.jsx(E,{variant:"soft",color:"gray",children:"Close"})}),e.jsx(E,{onClick:L,disabled:z,children:"Add"})]})]})},$e=f.createContext(null),W={didCatch:!1,error:null};class Re extends f.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=W}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var o,a,i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];(o=(a=this.props).onReset)===null||o===void 0||o.call(a,{args:c,reason:"imperative-api"}),this.setState(W)}}componentDidCatch(r,o){var a,i;(a=(i=this.props).onError)===null||a===void 0||a.call(i,r,o)}componentDidUpdate(r,o){const{didCatch:a}=this.state,{resetKeys:i}=this.props;if(a&&o.error!==null&&Be(r.resetKeys,i)){var c,u;(c=(u=this.props).onReset)===null||c===void 0||c.call(u,{next:i,prev:r.resetKeys,reason:"keys"}),this.setState(W)}}render(){const{children:r,fallbackRender:o,FallbackComponent:a,fallback:i}=this.props,{didCatch:c,error:u}=this.state;let h=r;if(c){const l={error:u,resetErrorBoundary:this.resetErrorBoundary};if(typeof o=="function")h=o(l);else if(a)h=f.createElement(a,l);else if(i!==void 0)h=i;else throw u}return f.createElement($e.Provider,{value:{didCatch:c,error:u,resetErrorBoundary:this.resetErrorBoundary}},h)}}function Be(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==r.length||t.some((o,a)=>!Object.is(o,r[a]))}const je=t=>{switch(t){case"integer":return{children:"Integer",color:"blue"};case"number":return{children:"Number",color:"purple"};case"float":return{children:"Float",color:"violet"};case"string":return{children:"String",color:"green"};case"boolean":return{children:"Boolean",color:"pink"};case"object":return{children:"Object",color:"orange"};case"array":return{children:"Array",color:"sky"};case"null":return{children:"Null",color:"gray"}}},Pe=t=>{const{control:r,getValues:o,setValue:a,watch:i}=w(),c=i("type"),[u,h]=f.useState("builder"),[l,n]=f.useState(void 0),d=()=>{try{const s=o("params"),p=typeof s=="string"?JSON.parse(s):s;a("params",JSON.stringify(p,null,4))}catch(s){we.error("Error formatting JSON. Please check your JSON."),n(s.message)}};return c!=="Custom Function"?null:e.jsx(C,{className:"py-2",children:e.jsxs(m,{children:[e.jsxs(g,{justify:"between",align:"start",children:[e.jsxs(g,{align:"center",children:[e.jsx(b,{weight:"medium",size:"2",children:"Builder"}),e.jsx(De,{size:"2",checked:u==="json",onCheckedChange:s=>h(s?"json":"builder")}),e.jsx(b,{weight:"medium",size:"2",children:"JSON"})]}),u==="json"&&e.jsx(E,{color:"gray",className:"not-cal font-medium",variant:"soft",type:"button",onClick:d,children:"Format JSON"})]}),l&&e.jsx(b,{size:"2",color:"red",children:l}),e.jsx(P,{control:r,name:"params",render:({field:s})=>{if(u==="builder")try{const p=typeof s.value=="string"?JSON.parse(s.value):s.value;return e.jsx(Re,{fallback:e.jsx(b,{size:"2",color:"red",children:"Error loading variables in the builder. Please check your JSON structure."}),children:e.jsx(ge,{json:p,onChange:j=>s.onChange(JSON.stringify(j,null,4))})})}catch(p){return e.jsx(b,{size:"2",color:"red",children:"Error loading variables in the builder. Please check your JSON structure."})}else return e.jsx(B,{rows:30,spellCheck:!1,className:"font-mono bg-gray-2 dark:bg-gray-1 text-amber-900 dark:text-amber-100",resize:"vertical",value:s.value,onChange:p=>s.onChange(p.target.value)})}})]})})},ge=({json:t,onChange:r,isNested:o})=>{const[a,i]=f.useState(void 0),c=t.properties||{},u=(l,n,d)=>{var p,j,D;let s=(p=t.required)!=null?p:[];d&&!T((j=t.required)!=null?j:[],l)&&s.push(l),!d&&T((D=t.required)!=null?D:[],l)&&(s=s.filter(v=>v!==l)),r({type:"object",properties:N(_({},c),{[l]:n}),required:s})},h=l=>{var s;const n=_({},c);delete n[l];const d=(s=t.required)==null?void 0:s.filter(p=>p!==l);r({type:"object",properties:n,required:d})};return e.jsxs(m,{children:[e.jsxs(m,{gap:"1",children:[Object.entries(c).length===0&&e.jsx(b,{size:"2",color:"gray",className:"text-center pt-4",children:"No variables defined"}),Object.entries(c).map(([l,n])=>{var d,s;return e.jsxs(m,{className:"bg-gray-2 dark:bg-gray-4 p-2.5 rounded-md shadow-sm hover:bg-gray-3 dark:hover:bg-gray-5",children:[e.jsxs(g,{justify:"between",align:"center",children:[e.jsxs(m,{gap:"1",children:[e.jsxs(g,{align:"center",children:[e.jsx(b,{className:"font-semibold",size:"2",children:l}),e.jsxs(g,{children:[e.jsx(A,N(_({},je(n.type)),{className:"rounded-md"})),T((d=t.required)!=null?d:[],l)&&e.jsx(A,{color:"red",className:"rounded-md",children:"Required"})]})]}),e.jsx(b,{size:"2",color:"gray",children:n.description}),(n.type==="string"||n.type==="number")&&n.enum&&n.enum.length>0&&e.jsxs(b,{as:"span",size:"2",color:"gray",weight:"medium",children:["Options: ",(s=n.enum)==null?void 0:s.join(", ")]})]}),e.jsxs(g,{align:"center",pr:"2",gap:"4",children:[e.jsx(J,{size:"2",color:"gray",variant:"ghost",type:"button",onClick:()=>i({name:l,properties:n}),children:e.jsx(de,{size:"16",className:"text-gray-10"})}),e.jsx(J,{size:"2",color:"red",variant:"ghost",type:"button",onClick:()=>h(l),children:e.jsx(ue,{size:"16"})})]})]}),n.type==="object"&&e.jsxs(m,{children:[e.jsx(ee,{className:"w-full"}),e.jsx(C,{ml:"8",p:"2",className:"bg-white dark:bg-gray-2 rounded-md",children:e.jsx(ge,{isNested:!0,json:n,onChange:p=>u(l,p)})})]})]},l)}),e.jsx(g,{py:"3",justify:o?"center":"start",children:e.jsx(Le,{onAdd:u})})]}),e.jsx(Ie,{variable:a,onSubmit:u,isOpen:a!==void 0,onOpenChange:l=>!l&&i(void 0)})]})},Le=({onAdd:t,buttonProps:r})=>{const[o,a]=f.useState(!1),i=(c,u,h)=>{t(c,u,h),a(!1)};return e.jsxs(U,{open:o,onOpenChange:a,children:[e.jsx(se,{children:e.jsx(E,N(_({size:"2",variant:"soft"},r),{children:"Add Variable"}))}),e.jsxs(G,{className:he,children:[e.jsx(V,{children:"Add Variable"}),e.jsx(Y,{children:"Add a new variable to your function schema."}),e.jsx(xe,{onAdd:i,allowNameChange:!0})]})]})},Ie=({variable:t,onSubmit:r,isOpen:o,onOpenChange:a})=>{const i=(c,u,h)=>{r(c,u,h),a(!1)};return e.jsx(U,{open:o,onOpenChange:a,children:e.jsxs(G,{className:he,children:[e.jsx(V,{children:"Edit Variable"}),e.jsx(ne,{children:e.jsx(Y,{children:"Edit the variable to your function schema."})}),e.jsx(xe,{onAdd:i,allowNameChange:!1,defaultValues:t==null?void 0:t.properties,defaultRequired:t==null?void 0:t.required,name:t==null?void 0:t.name})]})})},Je=t=>{const{control:r,getValues:o,setValue:a,watch:i}=w(),c=i("type"),u=i("reference_doctype");return T(["Create Document","Update Document","Create Multiple Documents","Update Multiple Documents"],c)&&u?e.jsx(Ue,{doctype:u}):null},Ue=({doctype:t})=>{const{control:r}=w(),{fields:o,append:a,remove:i,update:c}=Ne({control:r,name:"parameters"}),u=h=>{a(h)};return e.jsxs(m,{children:[e.jsxs(g,{justify:"end",align:"center",children:[e.jsx(He,{doctype:t,append:u}),e.jsx(Ve,{onAdd:u,doctype:t})]}),e.jsx(m,{children:o.map((h,l)=>e.jsx(Ge,{field:h,index:l,update:c,remove:i,doctype:t},h.id))})]})},Ge=({field:t,index:r,remove:o,doctype:a,update:i})=>{const{doc:c}=pe(a),u=n=>{i(r,n)},{options:h,type:l}=f.useMemo(()=>{var n,d;if(t.child_table_name){const s=(n=c==null?void 0:c.fields)==null?void 0:n.find(p=>p.fieldname===t.child_table_name);return{options:s==null?void 0:s.options,type:s==null?void 0:s.fieldtype}}else{const s=(d=c==null?void 0:c.fields)==null?void 0:d.find(p=>p.fieldname===t.fieldname);return{label:s==null?void 0:s.label,options:s==null?void 0:s.options,type:s==null?void 0:s.fieldtype}}},[t.child_table_name,t.fieldname,c]);return e.jsx(Se,{className:Fe({"bg-gray-6":t.do_not_ask_ai}),children:e.jsxs(g,{justify:"between",children:[e.jsxs(m,{children:[e.jsxs(g,{align:"center",gap:"2",children:[e.jsx(b,{className:"font-semibold",size:"2",children:t.fieldname}),e.jsx(ee,{orientation:"vertical"}),e.jsxs(g,{align:"center",children:[e.jsx(A,N(_({},je(t.type)),{className:"rounded-md"})),t.required?e.jsx(A,{color:"red",className:"rounded-md",children:"Required"}):null,t.options?e.jsx(qe,{content:t.options.split(`
`).join(", "),children:e.jsxs(A,{color:"blue",className:"rounded-md",children:[t.options.split(`
`).length," Options"]})}):null,t.do_not_ask_ai?e.jsx(A,{color:"gray",className:"rounded-md",children:"Do not ask AI"}):null]})]}),e.jsx(b,{size:"2",children:t.description}),e.jsxs(g,{align:"center",gap:"2",children:[t.default_value?e.jsxs(b,{size:"2",color:"gray",children:["Default Value: ",t.default_value]}):null,t.default_value&&t.child_table_name?e.jsx(ee,{orientation:"vertical"}):null,t.child_table_name&&T(["Table","Table MultiSelect"],l)?e.jsxs(b,{size:"2",color:"gray",children:["Child Table: ",h," (",t.child_table_name,")"]}):null]})]}),e.jsxs(g,{align:"center",pr:"2",gap:"4",children:[e.jsx(Ye,{onEdit:u,field:t,doctype:a}),e.jsx(J,{size:"2",color:"red",variant:"ghost",type:"button",onClick:()=>o(r),children:e.jsx(ue,{size:"16"})})]})]})})},Ve=({onAdd:t,doctype:r})=>{const[o,a]=f.useState(!1),i=c=>{t(c),a(!1)};return e.jsxs(U,{open:o,onOpenChange:a,children:[e.jsx(se,{children:e.jsx(E,{variant:"solid",type:"button",className:"not-cal",children:"Add"})}),e.jsxs(G,{children:[e.jsx(V,{children:"Add Variable"}),e.jsx(ne,{children:e.jsx(Y,{children:"Add a new variable in the function."})}),e.jsx(me,{doctype:r,onAdd:i})]})]})},Ye=({onEdit:t,field:r,doctype:o})=>{const[a,i]=f.useState(!1),c=u=>{t(u),i(!1)};return e.jsxs(U,{open:a,onOpenChange:i,children:[e.jsx(se,{children:e.jsx(J,{size:"2",color:"gray",variant:"ghost",type:"button",children:e.jsx(de,{size:"16",className:"text-gray-10"})})}),e.jsxs(G,{children:[e.jsx(V,{children:"Edit Variable"}),e.jsx(ne,{children:e.jsxs(Y,{children:["Edit variable - ",r.fieldname," in the function."]})}),e.jsx(me,{doctype:o,onAdd:c,defaultValues:r})]})]})},He=({doctype:t,append:r})=>{const{getValues:o,setValue:a}=w(),{doc:i,childDocs:c}=pe(t),u=(n,d)=>{var D,v,k;let s=(v=(D=n.label)!=null?D:n.fieldname)!=null?v:"",p="",j="string";return n.fieldtype==="Select"&&(p=(k=n.options)!=null?k:""),T(["Int","Rating"],n.fieldtype)&&(j="integer"),T(["Float","Currency","Percent"],n.fieldtype)&&(j="number"),n.fieldtype==="Percent"&&(s=`${n.label} in percentage (between 0 and 100)`),n.fieldtype==="Check"&&(j="boolean"),n.fieldtype==="Date"&&(s=`${n.label} in YYYY-MM-DD format`),n.fieldtype==="Datetime"&&(s=`${n.label} in YYYY-MM-DD HH:mm:ss format`),n.fieldtype==="Time"&&(s=`${n.label} in HH:mm:ss format`),d&&(s+=` in ${d}`),{fieldname:n.fieldname,description:s,options:p,type:j,required:n.reqd}},h=(n,d)=>{var p;const s=c==null?void 0:c.find(j=>j.name===n);return s?((p=s.fields)==null?void 0:p.filter(j=>j.reqd).map(j=>N(_({},u(j,s.name)),{child_table_name:d})))||[]:[]},l=()=>{var L,M;const n=o("parameters")||[],d=(L=i==null?void 0:i.fields)==null?void 0:L.filter(x=>x.reqd),s=d==null?void 0:d.filter(x=>x.fieldtype!=="Table"&&x.fieldtype!=="Table MultiSelect"),p=n.map(x=>x.fieldname),j=(s==null?void 0:s.filter(x=>{var q;return!p.includes((q=x.fieldname)!=null?q:"")}).map(x=>u(x)))||[],D=d==null?void 0:d.filter(x=>x.fieldtype==="Table"||x.fieldtype==="Table MultiSelect"),v=((M=D==null?void 0:D.map(x=>{var q,y;return h((q=x.options)!=null?q:"",(y=x.fieldname)!=null?y:"")}))!=null?M:[]).flat(),k=v==null?void 0:v.filter(x=>!n.some(y=>y.fieldname===x.fieldname&&y.child_table_name===x.child_table_name)),z=[...j,...k];z==null||z.forEach(x=>{r(x)})};return e.jsxs(E,{variant:"outline",type:"button",className:"not-cal",onClick:l,children:["Import fields from ",t]})},ce={size:18,className:"mr-1.5"},ct=({isEdit:t})=>{const{watch:r}=w(),o=r("type");return e.jsxs(Oe,{defaultValue:"function_details",children:[e.jsxs(Te,{children:[e.jsxs(ae,{value:"function_details",children:[e.jsx(ke,_({},ce))," Details"]}),e.jsxs(ae,{value:"variables",disabled:T(["Get Document","Get Multiple Documents","Delete Document","Delete Multiple Documents","Attach File to Document"],o),children:[e.jsx(Ae,_({},ce))," Variables"]})]}),e.jsxs(m,{pt:"4",children:[e.jsx(Me,{}),e.jsx(oe,{value:"function_details",children:e.jsx(Ke,{isEdit:t})}),e.jsx(oe,{value:"variables",children:e.jsx(We,{})})]})]})},Ke=({isEdit:t})=>{var u,h,l;const{register:r,control:o,formState:{errors:a},setValue:i}=w(),c=n=>{const d=$.find(s=>s.value===n.target.value);n.target.value==="Attach File to Document"&&(i("reference_doctype",""),i("function_name","attach_file_to_document"),i("description","This function attaches a file to a document in the system. Call this function after you have created or updated the document.")),d&&(d.requires_write_permissions!==void 0&&i("requires_write_permissions",d.requires_write_permissions?1:0),d.value!=="Custom Function"&&i("function_path",""))};return e.jsxs(m,{gap:"4",children:[e.jsxs(Ee,{columns:"2",gap:"4",children:[e.jsxs(m,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"type",isRequired:!0,children:"Type"}),e.jsx(P,{control:o,name:"type",rules:{required:"Type is required",onChange:c},render:({field:n})=>e.jsxs(Q,{value:n.value,name:n.name,onValueChange:d=>n.onChange(d),children:[e.jsx(X,{placeholder:"Pick a function type",className:"w-full",autoFocus:!0}),e.jsxs(Z,{children:[e.jsxs(H,{children:[e.jsx(K,{className:"pl-3",children:"Standard"}),$.filter(d=>d.type==="Standard").map(d=>e.jsx(S,{value:d.value,children:d.value},d.value))]}),e.jsxs(H,{children:[e.jsx(K,{className:"pl-3",children:"Miscellaneous"}),$.filter(d=>d.type==="Other").map(d=>e.jsx(S,{value:d.value,children:d.value},d.value))]}),e.jsxs(H,{children:[e.jsx(K,{className:"pl-3",children:"Bulk Operations"}),$.filter(d=>d.type==="Bulk Operations").map(d=>e.jsx(S,{value:d.value,children:d.value},d.value))]})]})]})})]}),e.jsx(Qe,{}),a.type&&e.jsx(R,{children:(u=a.type)==null?void 0:u.message})]}),e.jsx(tt,{}),e.jsxs(m,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"function_name",isRequired:!0,children:"Name"}),e.jsx(le,N(_({id:"function_name"},r("function_name",{required:"Name is required",disabled:t,validate:n=>n.includes(" ")?"Name cannot contain spaces":!0})),{readOnly:t,placeholder:"get_purchase_invoice","aria-invalid":a.function_name?"true":"false"}))]}),a.function_name&&e.jsx(R,{children:(h=a.function_name)==null?void 0:h.message}),e.jsx(F,{children:"This needs to be unique and cannot contain spaces."})]})]}),e.jsxs(m,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"description",isRequired:!0,children:"Description"}),e.jsx(P,{control:o,name:"description",render:({field:n})=>e.jsx(B,N(_({id:"description"},n),{placeholder:"Describe what this function does."}))})]}),a.description&&e.jsx(R,{children:(l=a.description)==null?void 0:l.message}),e.jsx(F,{children:"This is used to describe what this function does to the AI Agent."})]}),e.jsx(et,{}),e.jsx(Ze,{})]})},We=()=>e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsxs(m,{children:[e.jsx(Xe,{}),e.jsx(Pe,{})]})]}),Qe=()=>{const{watch:t}=w(),r=t("type"),o=$.find(a=>a.value===r);return o?e.jsx(F,{children:o.description}):e.jsx(F,{children:"Select a function type from the dropdown above."})},Xe=()=>{const{watch:t,control:r}=w();return t("type")!=="Custom Function"?null:e.jsxs(m,{maxWidth:"480px",children:[e.jsx(b,{as:"label",size:"2",children:e.jsxs(g,{children:[e.jsx(P,{control:r,name:"pass_parameters_as_json",render:({field:a})=>e.jsx(te,{checked:!!a.value,onCheckedChange:i=>a.onChange(i?1:0)})}),"Pass parameters as JSON"]})}),e.jsx(F,{children:"If checked, the params will be passed as a JSON object instead of named parameters"})]})},Ze=()=>{const{watch:t,control:r}=w(),o=t("type");return e.jsxs(m,{maxWidth:"480px",children:[e.jsx(b,{as:"label",size:"2",children:e.jsxs(g,{children:[e.jsx(P,{control:r,name:"requires_write_permissions",render:({field:a})=>e.jsx(te,{disabled:o!=="Custom Function",checked:!!a.value,onCheckedChange:i=>a.onChange(i?1:0)})}),"Requires Write Permissions"]})}),e.jsx(F,{children:"Check this if the function you have selected requires write permissions."})]})},et=()=>{var i;const{register:t,watch:r,formState:{errors:o}}=w(),a=r("type");return a!=="Custom Function"?null:e.jsxs(m,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"function_path",isRequired:a==="Custom Function",children:"Custom Function Path"}),e.jsx(B,N(_({id:"function_path"},t("function_path",{required:a==="Custom Function"?"Path is required":!1,validate:c=>c!=null&&c.includes(" ")?"Path cannot contain spaces":!0})),{placeholder:"myapp.api.my_custom_function"}))]}),e.jsx(F,{children:"Dotted path to the custom function/API. Cannot contain spaces."}),o.function_path&&e.jsx(R,{children:(i=o.function_path)==null?void 0:i.message})]})},tt=()=>{var h;const{watch:t,formState:{errors:r},setValue:o,getValues:a}=w(),i=t("type"),c=["Get Document","Get Multiple Documents","Get List","Create Document","Create Multiple Documents","Update Document","Update Multiple Documents","Delete Document","Delete Multiple Documents"],u=l=>{if(l.target.value){let n="";const d=!!a("function_name");let s="";i==="Get Document"&&(n=`This function fetches a ${l.target.value} document using its name from the system.`,s=`get_${l.target.value.toLowerCase().replace(/\s/g,"_")}`),i==="Get Multiple Documents"&&(n=`This function fetches multiple ${l.target.value} documents using their names from the system.`,s=`get_${l.target.value.toLowerCase().replace(/\s/g,"_")}s`),i==="Get List"&&(n=`This function fetches a list of ${l.target.value} from the system.`,s=`get_${l.target.value.toLowerCase().replace(/\s/g,"_")}_list`),i==="Create Document"&&(n=`This function creates a ${l.target.value} in the system.`,s=`create_${l.target.value.toLowerCase().replace(/\s/g,"_")}`),i==="Create Multiple Documents"&&(n=`This function creates multiple ${l.target.value} in the system.`,s=`create_${l.target.value.toLowerCase().replace(/\s/g,"_")}s`),i==="Update Document"&&(n=`This function updates a ${l.target.value} in the system.`,s=`update_${l.target.value.toLowerCase().replace(/\s/g,"_")}`),i==="Update Multiple Documents"&&(n=`This function updates multiple ${l.target.value} in the system.`,s=`update_${l.target.value.toLowerCase().replace(/\s/g,"_")}s`),i==="Delete Document"&&(n=`This function deletes a ${l.target.value} from the system.`,s=`delete_${l.target.value.toLowerCase().replace(/\s/g,"_")}`),i==="Delete Multiple Documents"&&(n=`This function deletes multiple ${l.target.value} from the system.`,s=`delete_${l.target.value.toLowerCase().replace(/\s/g,"_")}s`),s&&!d&&o("function_name",s),n&&o("description",n)}};return c.includes(i)?e.jsxs(m,{children:[e.jsx(ze,{name:"reference_doctype",label:"Reference Doctype",required:!0,filters:[["istable","=",0],["issingle","=",0]],doctype:"DocType",rules:{required:c.includes(i)?"Reference Doctype is required":!1,onChange:u}}),e.jsx(F,{children:"The document you want this function to operate on."}),r.reference_doctype&&e.jsx(R,{children:(h=r.reference_doctype)==null?void 0:h.message})]}):null};export{ct as F};
