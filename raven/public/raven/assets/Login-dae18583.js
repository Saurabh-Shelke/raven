var Q=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var I=(t,a,r)=>a in t?Q(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,z=(t,a)=>{for(var r in a||(a={}))R.call(a,r)&&I(t,r,a[r]);if(V)for(var r of V(a))T.call(a,r)&&I(t,r,a[r]);return t},_=(t,a)=>Y(t,Z(a));var q=(t,a,r)=>new Promise((o,d)=>{var c=s=>{try{n(r.next(s))}catch(u){d(u)}},m=s=>{try{n(r.throw(s))}catch(u){d(u)}},n=s=>s.done?o(s.value):Promise.resolve(s.value).then(c,m);n((r=r.apply(t,a)).next())});import{u as U,X,h as F,j as e,p as M,a as i,i as x,b as N,d as P,o as j,e as J,G as A,B as W,k as ee,r as k,l as ae,L as D,m as te,q as se,s as re,t as ie,f as H,g as L,W as ce,S as ne,v as le}from"./index-81db420b.js";import{A as de}from"./AuthContainer-6f4c35bc.js";import{D as oe}from"./DateSeparator-55fa17c4.js";const me={Email:"Email",SMS:"SMS","OTP App":"OTP"},ue=({loginWithTwoFAResponse:t,setError:a,setIsTwoFactorEnabled:r})=>{var g,f;const{register:o,handleSubmit:d,formState:{errors:c,isSubmitting:m}}=U(),{login:n}=X(),{appearance:s}=F();function u(h){return q(this,null,function*(){var b,y;a(null);const C={tmp_id:(b=t==null?void 0:t.tmp_id)!=null?b:"",otp:(y=h.otp)!=null?y:""};return n(C).then(v=>{const w="/raven";window.location.replace(`${w}`)}).catch(v=>a(v))})}const p=h=>h.method==="Email"||h.method==="SMS"?h.prompt:"Enter Code displayed in OTP App.";return e.jsx(M,{children:e.jsx("form",{onSubmit:d(u),children:e.jsxs(i,{direction:"column",gap:"4",width:"100%",children:[e.jsx(i,{direction:"column",gap:"2",children:e.jsx(M,{children:e.jsx(x,{size:"3",color:"gray",children:(g=t==null?void 0:t.verification)!=null&&g.setup?p(t==null?void 0:t.verification):`Verification ${me[(f=t==null?void 0:t.verification)==null?void 0:f.method]} not sent. Please contact Administrator.`})})}),e.jsxs(i,{direction:"column",gap:"4",children:[e.jsx(N,_(z({},o("otp",{required:"Verification Code is required."})),{name:"otp",type:"text",size:"3",variant:s==="dark"?"soft":void 0,color:"gray",required:!0,placeholder:"Verification Code",autoFocus:!0,tabIndex:0})),(c==null?void 0:c.otp)&&e.jsx(P,{children:c==null?void 0:c.otp.message})]}),e.jsx(i,{direction:"column",gap:"4",my:"2",children:e.jsx(j,{type:"submit",className:"not-cal font-medium",size:"3",children:m?e.jsx(J,{className:"text-white"}):"Verify"})}),e.jsx(i,{direction:"column",gap:"4",children:e.jsx(j,{className:"not-cal font-medium border-0 hover:bg-transparent hover:text-gray-12",variant:"ghost",type:"button",size:"3",color:"gray",onClick:()=>r(!1),children:"Cancel"})})]})})})};function he(t){return A({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`},child:[]},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`},child:[]}]})(t)}const G={github:e.jsx(W,{size:"24"}),google:e.jsx(he,{size:"24"}),facebook:e.jsx(ee,{size:"24",color:"#316FF6"})},pe=()=>{var w,E,O,$;const{appearance:t}=F(),{data:a,mutate:r}=K(),[o,d]=k.useState(null),{login:c}=X(),{register:m,handleSubmit:n,formState:{errors:s,isSubmitting:u}}=U(),[p,g]=k.useState(!1),[f,h]=k.useState(!1),[C,b]=k.useState(null),y=()=>{g(!p)};function v(S){return q(this,null,function*(){var B;return d(null),(B=a==null?void 0:a.message)!=null&&B.two_factor_is_enabled?c({username:S.email,password:S.password}).then(l=>{l!=null&&l.verification&&(l!=null&&l.tmp_id)&&(h(!0),b(l))}).catch(l=>d(l)):c({username:S.email,password:S.password}).then(()=>{const l="/raven";window.location.replace(`${l}`)}).catch(l=>{d(l)})})}return e.jsxs(de,{children:[o&&e.jsx(ae,{children:o.message}),f?e.jsx(ue,{loginWithTwoFAResponse:C,setError:d,setIsTwoFactorEnabled:h}):e.jsx(M,{children:e.jsx("form",{onSubmit:n(v),children:e.jsx(i,{direction:"column",gap:"6",children:e.jsxs(i,{direction:"column",gap:"4",children:[e.jsxs(i,{direction:"column",gap:"2",children:[e.jsx(D,{htmlFor:"email",isRequired:!0,size:"3",children:(w=a==null?void 0:a.message)==null?void 0:w.login_label}),e.jsx(N,_(z({},m("email",{required:`${(E=a==null?void 0:a.message)==null?void 0:E.login_label} is required.`})),{name:"email",type:"text",required:!0,id:"email",size:"3",color:"gray",variant:t==="dark"?"soft":void 0,placeholder:"jane@example.com",tabIndex:0})),(s==null?void 0:s.email)&&e.jsx(P,{children:s==null?void 0:s.email.message})]}),e.jsxs(i,{direction:"column",gap:"2",children:[e.jsx(D,{htmlFor:"password",isRequired:!0,size:"3",children:"Password"}),e.jsx(N,_(z({},m("password",{required:"Password is required."})),{name:"password",type:p?"text":"password",autoComplete:"current-password",required:!0,id:"password",size:"3",variant:t==="dark"?"soft":void 0,placeholder:"***********",color:"gray",children:e.jsx(te,{side:"right",children:e.jsx(se,{type:"button",size:"1",variant:"ghost","aria-label":p?"Mask password":"Reveal password",onClick:y,tabIndex:-1,children:p?e.jsx(re,{}):e.jsx(ie,{})})})})),(s==null?void 0:s.password)&&e.jsx(P,{children:(O=s.password)==null?void 0:O.message}),e.jsx(i,{direction:"column",gap:"2",align:"end",children:e.jsx(H,{asChild:!0,color:"gray",size:"2",children:e.jsx(L,{to:"/forgot-password",children:"Forgot Password?"})})})]}),e.jsx(i,{direction:"column",gap:"2",children:e.jsx(j,{type:"submit",disabled:u,size:"3",className:"not-cal font-medium",children:u?e.jsx(J,{className:"text-white"}):"Login"})})]})})})}),e.jsx(xe,{isSubmitting:u}),(($=a==null?void 0:a.message)==null?void 0:$.disable_signup)===0?e.jsxs(i,{gap:"1",justify:"center",children:[e.jsx(x,{size:"2",color:"gray",children:"Don't have an account yet?"}),e.jsx(H,{size:"2",asChild:!0,children:e.jsx(L,{to:"/signup",children:e.jsx(x,{children:"Sign Up"})})})]}):null]})},K=()=>ce("raven.api.login.get_context",{"redirect-to":"/raven"},"raven.api.login.get_context",{revalidateOnMount:!0,revalidateOnReconnect:!1,revalidateOnFocus:!1}),xe=({isSubmitting:t})=>{var r,o,d,c,m;const{data:a}=K();return e.jsxs(ne,{gap:"3",children:[(r=a==null?void 0:a.message)!=null&&r.login_with_email_link||(o=a==null?void 0:a.message)!=null&&o.social_login?e.jsx(i,{justify:"center",className:"mt-1 mb-5 w-full",children:e.jsx(oe,{className:"w-full",children:e.jsx(x,{size:"2",color:"gray",className:"uppercase",children:"or"})})}):null,(d=a==null?void 0:a.message)!=null&&d.social_login?(c=a==null?void 0:a.message)==null?void 0:c.provider_logins.map((n,s)=>e.jsx(i,{direction:"column",children:e.jsx(j,{size:"3",color:"gray",variant:"outline",className:"not-cal font-medium text-gray-12 dark:text-white",disabled:t,asChild:!0,children:e.jsxs(L,{to:n.auth_url,className:"flex items-center",children:[G[n.name]?G[n.name]:e.jsx("img",{src:n.icon.src,alt:n.icon.alt,style:{width:"20px",height:"20px"}}),"Continue with ",n.provider_name]})})},s)):null,(m=a==null?void 0:a.message)!=null&&m.login_with_email_link?e.jsx(i,{direction:"column",children:e.jsx(j,{type:"button",asChild:!0,size:"3",color:"gray",variant:"outline",className:"not-cal font-medium text-gray-12 dark:text-white",disabled:t,children:e.jsxs(L,{to:"/login-with-email",children:[e.jsx(le,{size:"24"}),e.jsx(x,{children:"Login with Email Link"})]})})}):null]})};pe.displayName="LoginPage";export{pe as Component,xe as OtherLoginMethods,G as SocialProviderIcons};
